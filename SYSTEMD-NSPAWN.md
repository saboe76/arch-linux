# systemd-nspawn

[Arch / systemd-nspawn](https://wiki.archlinux.org/title/Systemd-nspawn)

*
systemd-nspawn is like the chroot command, but it is a chroot on steroids.

systemd-nspawn may be used to run a command or operating system in a light-weight namespace container. It is more powerful than chroot since it fully virtualizes the file system hierarchy, as well as the process tree, the various IPC subsystems and the host and domain name.
*

## Install OS (Arch)

The images are generally kept unter `/var/lib/machines`.
So create `mkdir -p /var/lib/machines/test1` and pacstrap
a fresh install into this folder.
Symlinking or bind mounting `machines` to any other location will work.

```
pacstrap -K -c /var/lib/machines/test1
```

Before fireing up, create a configuration files for the machine
`/etc/systemd/nspawn/test1.nspawn`:


```
Exec]
MachineID=7f707aab-d07e-4342-86e0-dae3e7bf5dda

[Network]
MACVLAN=br0
```

The UUID is generated by `uuidgen`.
To get a stable MAC that is not infuenced by the container name `test1` is not working for me.
Anway, to bridge the container network interface a physical one connected,
we can use the `MACVLAN`.
